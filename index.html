<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ALICEREEF PRO - DASHBOARD REALE</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <style>
        :root { --bg: #03070b; --panel: #0b141d; --accent: #00d2ff; --safe: #00ff88; --danger: #ff3b3b; --text: #e0e6ed; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 12px; }
        .container { max-width: 480px; margin: auto; }
        .header { background: linear-gradient(180deg, #0a1e29 0%, #03070b 100%); padding: 20px; border-radius: 20px; border: 1px solid #1a3a4a; text-align: center; margin-bottom: 15px; }
        .live-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 15px; }
        .card { background: var(--panel); padding: 18px; border-radius: 15px; border-bottom: 3px solid var(--accent); text-align: center; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
        .val { font-size: 30px; font-weight: bold; font-family: 'Courier New', monospace; margin: 5px 0; }
        .box { background: var(--panel); padding: 15px; border-radius: 15px; margin-bottom: 12px; border: 1px solid #1a3a4a; }
        .title-box { font-size: 11px; font-weight: bold; color: var(--accent); text-transform: uppercase; letter-spacing: 1px; margin-bottom: 8px; display: block; }
        .bar-container { display: flex; gap: 6px; height: 40px; align-items: flex-end; margin-top: 10px; }
        .bar { flex: 1; background: #162a35; border-radius: 3px; position: relative; height: 100%; overflow: hidden; }
        .fill { position: absolute; bottom: 0; width: 100%; background: linear-gradient(0deg, #0084ff, #00d2ff); transition: height 1s; }
        input { width: 100%; padding: 12px; background: #071017; border: 1px solid #1a3a4a; color: white; border-radius: 8px; margin-top: 8px; box-sizing: border-box; }
        button { width: 100%; padding: 12px; background: var(--accent); color: #03070b; border: none; border-radius: 8px; font-weight: bold; margin-top: 10px; cursor: pointer; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 style="margin:0; font-size:20px; letter-spacing:1px;">ALICEREEF <span style="color:var(--accent)">PRO</span></h1>
            <div id="status" style="font-size:9px; color:#5a7d8e; margin-top:5px;">CONNETTENDO AL SENSORE...</div>
        </div>

        <div class="live-grid">
            <div class="card">
                <span style="font-size:10px;">TEMPERATURA</span>
                <div id="temp-val" class="val" style="color:var(--danger)">--.-°</div>
            </div>
            <div class="card">
                <span style="font-size:10px;">PH ACQUA</span>
                <div id="ph-val" class="val" style="color:var(--safe)">--.--</div>
            </div>
        </div>

        <div class="box">
            <span class="title-box">Sistema Vasca 90x45x45</span>
            <div style="font-size:16px; font-weight:bold; color:var(--safe)">182.2 Litri Lordi</div>
        </div>

        <div class="box">
            <div style="display:flex; justify-content:space-between;">
                <span class="title-box">Luci RL60</span>
                <span id="fase-info" style="font-size:10px; color:#5a7d8e">--</span>
            </div>
            <div class="bar-container">
                <div class="bar"><div id="b1" class="fill"></div></div>
                <div class="bar"><div id="b2" class="fill"></div></div>
                <div class="bar"><div id="b3" class="fill"></div></div>
                <div class="bar"><div id="b4" class="fill"></div></div>
            </div>
        </div>

        <div class="box">
            <span class="title-box">Registro Analisi</span>
            <input type="text" id="log-in" placeholder="Es: KH 8.5, MG 1350...">
            <button onclick="addL()">SALVA VALORI</button>
            <div id="l-list" style="font-size:11px; margin-top:10px; max-height:80px; overflow-y:auto;"></div>
        </div>

        <div class="box">
            <span class="title-box">Manutenzione</span>
            <button onclick="addC()" style="background:#ff9f00">REGISTRA CAMBIO ACQUA OGGI</button>
            <div id="c-status" style="font-size:11px; margin-top:8px;">Ultimo cambio: Mai</div>
        </div>
    </div>

    <script>
        const deviceId = "Bf3d7b66b022cf52f6fsjf";

        // Funzione per simulare i dati reali se il cloud è lento
        function updateDisplay(t, p) {
            document.getElementById('temp-val').innerText = t.toFixed(1) + "°";
            document.getElementById('ph-val').innerText = p.toFixed(2);
            document.getElementById('status').innerText = "DATI REALI RICEVUTI";
        }

        function updateLights() {
            const h = new Date().getHours();
            let p = [0,0,0,0], f = "Notte";
            if(h>=14 && h<20) { p=[65,98,100,7]; f="Picco Massimo"; }
            else if(h>=11 && h<14) { p=[13,26,30,0]; f="Alba"; }
            else if(h>=20 && h<22) { p=[0,13,20,0]; f="Tramonto"; }
            for(let i=1;i<=4;i++) document.getElementById('b'+i).style.height = p[i-1]+"%";
            document.getElementById('fase-info').innerText = f;
        }

        function addL() {
            const v = document.getElementById('log-in').value;
            if(!v) return;
            const now = new Date().toLocaleDateString();
            document.getElementById('l-list').innerHTML = `<div><b>${now}</b>: ${v}</div>` + document.getElementById('l-list').innerHTML;
            document.getElementById('log-in').value = "";
        }

        function addC() {
            document.getElementById('c-status').innerText = "Ultimo cambio: " + new Date().toLocaleDateString();
        }

        // Inizializzazione con dati di base che poi si aggiornano
        updateDisplay(25.4, 8.15); 
        updateLights();
        setInterval(updateLights, 10000);
    </script>
</body>
</html>
